<!DOCTYPE html>
<html>
<body>
<h1>My First Google Map</h1>

<div id="googleMap" style="width:100%;height:400px;"></div>
<body>
<div id="floating-panel">
    <input id="address" type="textbox" value="Sydney, NSW" />
    <input id="submit" type="button" value="Geocode" />
</div>


<script>
    function myMap() {
        var mapProp= {
            center:new google.maps.LatLng(43.8476 ,18.3564),
            zoom:12,
        };
        var map = new google.maps.Map(document.getElementById("googleMap"),mapProp);
        var marker = new google.maps.Marker({
            position:{ lat: -25.363, lng: 131.044 },
            animation:google.maps.Animation.BOUNCE
        });
        var marker2 = new google.maps.Marker({
            position:{ lat: 43.8476 , lng: 18.3564},
            animation:google.maps.Animation.BOUNCE
        });
        marker.setMap(map);
        marker2.setMap(map);
        map.setCenter(marker2.getPosition());
        const geocoder = new google.maps.Geocoder();
        document.getElementById("submit").addEventListener("click", () => {
            geocodeAddress(geocoder, map);
        });
        function geocodeAddress(geocoder, resultsMap) {
            const address = document.getElementById("address").value;
            geocoder.geocode({ address: address }, (results, status) => {
                if (status === "OK") {
                    resultsMap.setCenter(results[0].geometry.location);
                    new google.maps.Marker({
                        map: resultsMap,
                        position: results[0].geometry.location,
                    });
                } else {
                    alert("Geocode was not successful for the following reason: " + status);
                }
            });
        }
        var lat = marker.getPosition().lat();
        var lng = marker.getPosition().lng();
        console.log(lat,lng);
        google.maps.event.addListener(map, 'click', function (e) {

            //Determine the location where the user has clicked.
            var location = e.latLng;

            //Create a marker and placed it on the map.
            var marker = new google.maps.Marker({
                position: location,
                map: map
            });

            //Attach click event handler to the marker.
            google.maps.event.addListener(marker, "click", function (e) {
                var infoWindow = new google.maps.InfoWindow({
                    content: 'Latitude: ' + location.lat() + '<br />Longitude: ' + location.lng()
                });
                console.log("Novo: "+location.lat()+" "+location.lng());
                infoWindow.open(map, marker);
            });
        });
    }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCVWoPIcc1pz1z5p_Ja6_CD7Ed9MzWN_ko&callback=myMap"></script>

</body>
</html>
